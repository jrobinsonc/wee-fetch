"use strict";var __awaiter=this&&this.__awaiter||function(t,o,a,c){return new(a=a||Promise)(function(r,e){function i(t){try{s(c.next(t))}catch(t){e(t)}}function n(t){try{s(c.throw(t))}catch(t){e(t)}}function s(t){var e;t.done?r(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(i,n)}s((c=c.apply(t,o||[])).next())})},__rest=this&&this.__rest||function(t,e){var r={};for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},__importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0});const cross_fetch_1=__importDefault(require("cross-fetch"));class Fetcher{constructor(t,e=void 0){this.baseUrl=t,this.defArgs=null!=e?e:{}}request(n,s=void 0){var o;return __awaiter(this,void 0,void 0,function*(){var t=`${this.baseUrl}/${n}`,e=null!=s?s:{},r=e["body"],e=__rest(e,["body"]);const i=Object.assign(Object.assign({headers:Object.assign(Object.assign({},null!==(o=null==s?void 0:s.headers)&&void 0!==o?o:{}),{Accept:"application/json"}),credentials:"include"},null!==(o=this.defArgs)&&void 0!==o?o:{}),e);return r instanceof URLSearchParams||r instanceof FormData?i.body=r:i.body=JSON.stringify(r),i.body instanceof FormData==!1&&(i.headers=Object.assign(Object.assign({},i.headers),{"Content-Type":"application/json"})),cross_fetch_1.default(t,i).then(t=>__awaiter(this,void 0,void 0,function*(){return t.text()})).then(t=>{try{return JSON.parse(t)}catch(t){throw new Error("Invalid response received.")}})})}static serializeQueryArgs(t=void 0){const e=void 0===t?[]:Object.entries(t);return 0===e.length?"":e.filter(([,t])=>null!==t).map(([t,e])=>`${t}=${encodeURIComponent(e)}`).join("&")}static buildUrl(t,e=void 0){e=Fetcher.serializeQueryArgs(e);return""===e?t:`${t}?${e}`}get(r,i=void 0,n=void 0){return __awaiter(this,void 0,void 0,function*(){var t=Object.assign(Object.assign({},n),{method:"GET"}),e=Fetcher.buildUrl(r,i);return this.request(e,t)})}post(e,r=void 0,i=void 0){return __awaiter(this,void 0,void 0,function*(){var t=Object.assign(Object.assign({},i),{method:"POST",body:r});return this.request(e,t)})}put(e,r=void 0,i=void 0){return __awaiter(this,void 0,void 0,function*(){var t=Object.assign(Object.assign({},i),{method:"PUT",body:r});return this.request(e,t)})}delete(e,r=void 0){return __awaiter(this,void 0,void 0,function*(){var t=Object.assign(Object.assign({},r),{method:"DELETE"});return this.request(e,t)})}}exports.default=Fetcher;